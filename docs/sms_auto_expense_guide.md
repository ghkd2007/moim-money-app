# SMS 자동 지출 추가 기능 가이드

## 개요
SMS 자동 지출 추가 기능은 은행이나 카드사에서 보내는 결제 알림 메시지를 자동으로 읽어와서 지출에 추가하는 기능입니다.

## 주요 기능

### 1. SMS 권한 관리
- **권한 요청**: 사용자가 처음 기능을 사용할 때 SMS 읽기 권한을 요청
- **권한 확인**: 앱 실행 시 SMS 권한 상태를 확인
- **권한 거부 처리**: 권한이 거부된 경우 적절한 안내 메시지 표시

### 2. SMS 메시지 파싱
- **금액 추출**: 다양한 형식의 금액 정보를 자동으로 인식
  - `1,000원`, `1000원`, `1,000.00` 등
- **카테고리 자동 분류**: 메시지 내용을 분석하여 적절한 카테고리로 분류
  - 식비, 교통, 쇼핑, 의료, 교육, 엔터테인먼트 등
- **설명 생성**: 은행/카드사명을 제거하고 핵심 내용만 추출
- **신뢰도 계산**: 파싱 결과의 정확도를 백분율로 표시

### 3. 사용자 인터페이스
- **홈 화면 버튼**: "SMS 자동 추가" 버튼으로 쉽게 접근
- **모달 인터페이스**: 전체 화면 모달로 SMS 내용을 명확하게 표시
- **확인 다이얼로그**: 지출 추가 전 사용자 확인을 받음
- **일괄 추가**: 여러 지출을 한 번에 추가할 수 있는 기능

## 지원하는 메시지 형식

### 은행/카드사별 예시
```
신한카드 결제 15,000원 (식당)
KB국민카드 사용 8,500원 편의점
삼성카드 결제 12,000원 온라인쇼핑
현대카드 사용 25,000원 백화점
```

### 파싱 결과 예시
```
💰 금액: 15,000원
📝 내용: 결제 (식당)
🏷️ 카테고리: 식비
📅 날짜: 2024-01-15
신뢰도: 90%
```

## 기술적 구현

### 1. 사용된 라이브러리
- `expo-sms`: SMS 관련 기능
- `expo-permissions`: 권한 관리
- `expo-notifications`: 알림 기능

### 2. 주요 컴포넌트
- `SMSAutoExpenseModal`: SMS 자동 지출 추가 모달
- `smsService`: SMS 관련 비즈니스 로직
- `HomeScreen`: SMS 버튼 및 모달 통합

### 3. 데이터 흐름
1. 사용자가 "SMS 자동 추가" 버튼 클릭
2. SMS 권한 확인 및 요청
3. SMS 메시지 읽기
4. 메시지 내용 파싱 및 지출 정보 추출
5. 사용자 확인 후 지출 데이터 저장
6. 홈 화면 데이터 새로고침

## 보안 및 개인정보

### 1. 권한 관리
- SMS 읽기 권한은 사용자가 명시적으로 허용해야 함
- 권한 거부 시 기능 사용 불가
- 앱 설정에서 언제든지 권한 해제 가능

### 2. 데이터 처리
- SMS 내용은 로컬에서만 처리
- 외부 서버로 전송되지 않음
- 파싱된 지출 정보만 앱 내부에 저장

### 3. 사용자 동의
- 지출 추가 전 항상 사용자 확인을 받음
- 일괄 추가 시에도 개별 확인 가능
- 언제든지 취소 가능

## 사용 방법

### 1. 첫 사용 시
1. 홈 화면에서 "SMS 자동 추가" 버튼 클릭
2. SMS 읽기 권한 허용
3. SMS 메시지 분석 및 지출 정보 확인
4. 원하는 지출 선택하여 추가

### 2. 일상 사용
1. "SMS 자동 추가" 버튼 클릭
2. 파싱된 지출 목록 확인
3. 개별 추가 또는 일괄 추가 선택
4. 확인 후 지출 데이터 저장

### 3. 설정 관리
- 설정 > 자동화 > SMS 자동 지출 추가에서 기능 정보 확인
- 권한 관리 및 기능 설명 제공

## 제한사항

### 1. 플랫폼 제한
- Android: SMS 읽기 권한 필요
- iOS: 제한적인 SMS 접근 (보안 정책상)

### 2. 메시지 형식
- 표준화된 은행/카드사 메시지만 지원
- 비정형 메시지는 파싱 실패 가능
- 신뢰도가 낮은 경우 수동 입력 권장

### 3. 성능
- 대량의 SMS가 있는 경우 로딩 시간 증가
- 메모리 사용량 증가 가능

## 향후 개선 계획

### 1. 기능 확장
- 더 많은 은행/카드사 메시지 형식 지원
- AI 기반 지능형 카테고리 분류
- 수입 메시지도 자동 인식

### 2. 사용자 경험
- 자동 새로고침 기능
- 즐겨찾기 메시지 관리
- 개인화된 파싱 규칙 설정

### 3. 성능 최적화
- 백그라운드 처리
- 캐싱 및 인덱싱
- 배치 처리 최적화

## 문제 해결

### 1. 권한 문제
- **권한이 거부됨**: 설정 > 앱 > 권한에서 SMS 권한 확인
- **권한 요청 실패**: 앱 재시작 후 다시 시도

### 2. 파싱 실패
- **메시지 인식 안됨**: 표준 형식이 아닌 경우 수동 입력
- **카테고리 오류**: 수동으로 카테고리 수정 가능

### 3. 성능 문제
- **로딩 느림**: 대량 SMS가 있는 경우 시간 소요
- **메모리 부족**: 앱 재시작으로 해결

## 결론

SMS 자동 지출 추가 기능은 사용자의 편의성을 크게 향상시키는 핵심 기능입니다. 은행/카드사 메시지를 자동으로 분석하여 지출을 효율적으로 관리할 수 있으며, 사용자 확인을 통해 데이터 정확성도 보장합니다.

이 기능을 통해 사용자는 수동 입력의 번거로움을 줄이고, 더 정확하고 일관된 지출 기록을 유지할 수 있습니다.


